// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

generator client {
  provider      = "prisma-client-js"
  binaryTargets = ["native", "darwin", "debian-openssl-1.1.x"]
}

model User {
  uuid             String     @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  email            String     @unique
  username         String     @unique
  displayName      String
  password         String
  createdAt        DateTime   @default(now()) @db.Timestamptz
  updatedAt        DateTime   @default(now()) @updatedAt @db.Timestamptz
  stripeCustomerId String?
  roles            RoleEnum[]
  bookings         Booking[]
}

model Event {
  uuid                String          @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  title               String
  category            EventCategories @relation(fields: [eventCategoriesUuid], references: [uuid])
  eventCategoriesUuid String          @db.Uuid
  startDate           DateTime        @db.Timestamptz
  endDate             DateTime?       @db.Timestamptz
  description         String?
  price               Float?
  bookings            Booking[]

}

model EventCategories {
  uuid   String  @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  name   String
  events Event[]
}

model Booking {
  event Event @relation(fields: [eventUuid], references: [uuid])
  user  User  @relation(fields: [userUuid], references: [uuid])

  eventUuid String @db.Uuid
  userUuid  String @db.Uuid
  @@id([eventUuid, userUuid])
}

enum RoleEnum {
  DEV
  ADMIN
}
